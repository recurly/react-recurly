{"version":3,"file":"useCheckoutPricing-d9abab61.js","sources":["../../../docs/2-hooks/useCheckoutPricing.mdx"],"sourcesContent":["import { Meta, Subtitle } from '@storybook/blocks';\n\n<Meta title=\"Hooks/useCheckoutPricing\" />\n\n# useCheckoutPricing\n\n`import { useCheckoutPricing } from '@recurly/react-recurly';`\n\nUse this [hook][react-hooks] to interact with the [Recurly.js pricing API][rjs-pricing] and provide users with an estimate of a purchase before they check out.\n\n## Initializing\n\nTo initialize, call `useCheckoutPricing` [with an initial checkout pricing input][use-checkout-pricing-input] from any component inside a [RecurlyProvider][recurly-provider].\n\n```js\nimport { useCheckoutPricing, RecurlyProvider } from '@recurly/react-recurly';\n\nfunction PricingPreview () {\n  const initialPricingInput = {\n    subscriptions: [\n      {\n        plan: 'my-plan'\n      }\n    ]\n  };\n\n  const [{ price, loading }, setCheckoutPricing] = useCheckoutPricing(initialPricingInput);\n\n  if (!loading) {\n    return <div>{price.now.subtotal}</div>\n  };\n};\n\nexport default function MyApp () {\n  <RecurlyProvider>\n    // useCheckoutPricing can only be used by a component within a RecurlyProvider tree\n    <PricingPreview />\n  </RecurlyProvider>\n};\n```\n\nCalling `useCheckoutPricing` returns an array of two items:\n\n1. A [useCheckoutPricingState][use-checkout-pricing-state] object for reading output.\n2. A [setCheckoutPricing][set-checkout-pricing] function for updating input values.\n\nFor complete documentation on what `useCheckoutPricing` returns, see the [useCheckoutPricingReturn types page][use-checkout-pricing-return].\n\n## Initializing\n\nIt's important to know that immediately after calling `useCheckoutPricing`, [useCheckoutPricingState.price][use-checkout-pricing-state] will default to an empty object while waiting for asynchronous actions to resolve.\n\nThe below example will throw a type error because of this.\n```js\nexport default function PricingPreview () {\n  const initialPricingInput = {\n    subscriptions: [\n      {\n        plan: 'my-plan'\n      }\n    ]\n  };\n\n  const [{ price }, setCheckoutPricing] = useCheckoutPricing(initialPricingInput);\n\n  return <div>{price.now.subtotal}</div>\n};\n```\n\nThe [loading state](#loading-state) can be checked before rendering anything that uses [useCheckoutPricingState.price][use-checkout-pricing-state] to circumvent the error.\n\n```js\nexport default function PricingPreview () {\n  const initialPricingInput = {\n    subscriptions: [\n      {\n        plan: 'my-plan'\n      }\n    ]\n  };\n\n  const [{ price, loading }, setCheckoutPricing] = useCheckoutPricing(initialPricingInput);\n\n  if (!loading) {\n    return <div>{price.now.subtotal}</div>\n  };\n};\n```\n\nExistence checking can be used as well.\n\n```js\nexport default function PricingPreview () {\n  const initialPricingInput = {\n    subscriptions: [\n      {\n        plan: 'my-plan'\n      }\n    ]\n  };\n\n  const [{ price }, setCheckoutPricing] = useCheckoutPricing(initialPricingInput);\n\n  return <div>{price.now && price.now.subtotal}</div>\n};\n```\n\n## Updating\n\nCalling [setCheckoutPricing][set-checkout-pricing] with a [useCheckoutPricingInput][use-checkout-pricing-input] will recalculate its associated [useCheckoutPricingState][use-checkout-pricing-state] and re-render the underlying component.\n\nFor example, if a customer wishes to choose a different plan for their subscription on a checkout page and the price preview needs to be updated, calling [setCheckoutPricing][set-checkout-pricing] with new inputs will update [useCheckoutPricingState][use-checkout-pricing-state] and trigger a re-render with the updated values.\n\n```js\nexport default function PricingPreview () {\n  const [plan, setPlan] = useState('');\n  const initialPricingInput = {\n    subscriptions: [\n      {\n        plan: 'my-plan'\n      }\n    ]\n  };\n\n  const [{ price, loading }, setCheckoutPricing] = useCheckoutPricing(initialPricingInput);\n\n  const handleChange = e => {\n    const newPlan = e.target.value;\n    setPlan(newPlan);\n\n    // calling setCheckoutPricing here with new input values will update `price` and trigger a re-render\n    setCheckoutPricing({ subscriptions: [{ plan: newPlan }] });\n  }\n\n  if (!loading) {\n    return <div>\n      <div>\n        {price.now.subtotal}\n      </div>\n      <select value={plan} onChange={handleChange}>\n        <option value=\"\">Select a plan</option>\n        <option value=\"my-plan\">My plan</option>\n        <option value=\"my-second-plan\">My second plan</option>\n      </select>\n    </div>\n  };\n};\n```\n\n[setCheckoutPricing][set-checkout-pricing] is an implementation of [react state][react-use-state] and follows the same rules and patterns. It's also possible pass a function to [setCheckoutPricing][set-checkout-pricing] that accepts its previous inputs as the first and only argument:\n\n```js\nsetCheckoutPricing(previous => ({ ...previous, subscriptions: [{ plan: newPlan }] }));\n```\n\n## Loading state\n\nBecause Recurly.js' pricing API is asynchronous, a loading state is provided as a boolean.\n\n```js\nexport default function PricingPreview () {\n  const [plan, setPlan] = useState(null)\n\n  const initialPricingInput = {\n    subscriptions: [\n      {\n        plan: 'my-plan'\n      }\n    ]\n  };\n\n  const [{ loading }, setCheckoutPricing] = useCheckoutPricing(initialPricingInput);\n\n  if (loading) {\n    return <div>Loading...</div>\n  };\n  ...\n};\n```\n\nWhen `useCheckoutPricing` is first initiated or when it's updated with [setCheckoutPricing][set-checkout-pricing], [useCheckoutPricingState.loading][use-checkout-pricing-state] will be set to `true` until its asynchronous actions have resolved, then set back to `false`.\n## Error handling\n\nAny errors from `useCheckoutPricing` will be thrown by default. Passing a function as the second argument to `useCheckoutPricing` allows errors to be caught and handled.\n\n```js\nexport default function PricingPreview () {\n  const [recurlyError, setRecurlyError] = useState(null);\n\n  const initialPricingInput = {\n    subscriptions: [\n      {\n        plan: 'my-plan'\n      }\n    ]\n  };\n\n  const [{ price, loading }, setCheckoutPricing] = useCheckoutPricing(initialPricingInput, setRecurlyError);\n\n  if (recurlyError && !loading) {\n    return <div>Error: {recurlyError.message}</div>\n  };\n  ...\n};\n```\n\nErrors will always take the shape of a [Recurly.js error][recurly-error].\n\n## Demo\n\nFor a full example of `useCheckoutPricing`, see our [interactive demo][interactive-demo].\n\n[react-hooks]: https://reactjs.org/docs/hooks-intro.html\n[rjs-pricing]: https://developers.recurly.com/reference/recurly-js/#pricing\n[react-use-state]: https://reactjs.org/docs/hooks-state.html\n[recurly-error]: https://developers.recurly.com/reference/recurly-js/#errors\n[recurly-provider]: /?path=/docs/components-recurlyprovider--page\n[interactive-demo]: /?path=/docs/introduction-interactive-demo--page\n[set-checkout-pricing]: /?path=/docs/types-usecheckoutpricingreturn--page#setcheckoutpricing\n[use-checkout-pricing-state]: /?path=/docs/types-usecheckoutpricingreturn--page#usecheckoutpricingstate\n[use-checkout-pricing-return]: /?path=/docs/types-usecheckoutpricingreturn--page\n[use-checkout-pricing-input]: /?path=/docs/types-usecheckoutpricinginput--page\n[use-checkout-pricing-updating]: /?path=/docs/types-usecheckoutpricinginput--page#updating\n"],"names":["_createMdxContent","props","_components","_provideComponents","_jsxs","_Fragment","_jsx","Meta","MDXContent","MDXLayout"],"mappings":"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"}